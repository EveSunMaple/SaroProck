---
// src/pages/random.astro
import { getCollection } from "astro:content";

const allPosts = await getCollection("blog", ({ data }) => data.draft !== true);
if (allPosts.length === 0) return Astro.redirect("/");

return Astro.redirect(
  encodeURI(
    `/blog/${allPosts[Math.floor(Math.random() * allPosts.length)].slug}`,
  ),
  307,
);
---