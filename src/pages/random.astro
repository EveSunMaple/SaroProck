---
// src/pages/random.astro
import { getCollection } from "astro:content";

const allPosts = await getCollection("blog", ({ data }) => data.draft !== true);
if (allPosts.length === 0) return Astro.redirect("/");

const randomPost = allPosts[Math.floor(Math.random() * allPosts.length)];
const redirectUrl = encodeURI(`/blog/${randomPost.slug}`);

return Astro.redirect(redirectUrl, 307);
---